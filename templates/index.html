<!DOCTYPE html>
<html lang="uz">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ data.name }} | Shaxsiy Sahifa</title>
    <meta name="description" content="{{ data.name }} - {{ data.bio }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>

<body>
    <div class="grid-container">
        <!-- Left Column: Profile -->
        <aside class="profile-card">
            <div class="img-container">
                <img src="{{ data.profile_image }}" alt="{{ data.name }}" class="profile-img"
                    onerror="this.src='https://ui-avatars.com/api/?name={{ data.name }}&background=10b981&color=fff&size=200'">
            </div>
            <h1 class="name">{{ data.name }}</h1>
            <p class="role">Full-Stack Dasturchi | Mentor</p>

            <p class="bio">
                {{ data.bio }}
            </p>

            <div class="social-bar">
                <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
                <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
                <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                <a href="mailto:contact@example.com" class="social-icon"><i class="fas fa-envelope"></i></a>
            </div>
        </aside>

        <!-- Right Column: Links Grid -->
        <main class="content-area">
            <div class="section-title">Mening Havolalarim</div>

            <div class="links-grid">
                {% if data.links %}
                {% for link in data.links %}
                <!-- Link Item -->
                {% if link.sublinks %}
                <!-- Folder/Modal Link -->
                <a href="javascript:void(0)" class="grid-item" onclick='openModal({{ link | tojson }})'>
                    <div class="card-icon">
                        <i class="{{ link.icon }}"></i>
                    </div>
                    <div class="card-bottom">
                        <h3>{{ link.title }}</h3>
                        <p>{{ link.description or "Tanlash uchun bosing..." }}</p>
                    </div>
                </a>
                {% else %}
                <!-- Standard Link -->
                <a href="{{ link.url if link.active else '#' }}"
                    class="grid-item {{ 'disabled' if not link.active else '' }}"
                    target="{{ '_blank' if link.active else '_self' }}" rel="noopener noreferrer">
                    {% if not link.active %}
                    <div class="badge-soon">Tez orada</div>
                    {% endif %}
                    <div class="card-icon">
                        {% if link.icon %}
                        <i class="{{ link.icon }}"></i>
                        {% else %}
                        <i class="fas fa-link"></i>
                        {% endif %}
                    </div>
                    <div class="card-bottom">
                        <h3>{{ link.title }}</h3>
                        <p>{{ link.description or "Batafsil ma'lumot..." }}</p>
                    </div>
                    {% if link.active %}
                    <i class="fas fa-arrow-right arrow-icon"></i>
                    {% endif %}
                </a>
                {% endif %}
                {% endfor %}
                {% else %}
                <div class="empty-state"
                    style="grid-column: 1 / -1; text-align: center; color: #9ca3af; padding: 2rem;">
                    <p>Hozircha havolalar yo'q.</p>
                </div>
                {% endif %}
            </div>
        </main>

        <footer class="main-footer">
            &copy; 2024 {{ data.name }}. Barcha huquqlar himoyalangan.
        </footer>
    </div>

    <!-- Modal Structure -->
    <div class="modal-overlay" id="linkModal" onclick="closeModal(event)">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <i id="modalIcon" class=""></i>
                    <span id="modalTitle">Title</span>
                </div>
                <button class="modal-close" onclick="closeModal(event, true)">&times;</button>
            </div>
            <div id="modalLinks" class="modal-body">
                <!-- Sublinks will be injected here -->
            </div>
        </div>
    </div>

    <script>
        function openModal(linkData) {
            const modal = document.getElementById('linkModal');
            const title = document.getElementById('modalTitle');
            const icon = document.getElementById('modalIcon');
            const linksContainer = document.getElementById('modalLinks');

            // Setup Header
            title.textContent = linkData.title;
            icon.className = linkData.icon;

            // Clear previous links
            linksContainer.innerHTML = '';

            // Add new links
            if (linkData.sublinks) {
                linkData.sublinks.forEach(sub => {
                    const a = document.createElement('a');
                    a.className = 'sublink-item';
                    a.href = sub.url;
                    a.target = '_blank';

                    a.innerHTML = `
                        <div class="sublink-icon"><i class="${sub.icon || 'fas fa-link'}"></i></div>
                        <span class="sublink-text">${sub.title}</span>
                    `;
                    linksContainer.appendChild(a);
                });
            }

            // Show Modal
            modal.style.display = 'flex';
            // Small delay for animation
            setTimeout(() => {
                modal.classList.add('active');
            }, 10);
        }

        function closeModal(event, force = false) {
            if (force || event.target === document.getElementById('linkModal')) {
                const modal = document.getElementById('linkModal');
                modal.classList.remove('active');
                setTimeout(() => {
                    modal.style.display = 'none';
                }, 300);
            }
        }
    </script>
</body>

</html>